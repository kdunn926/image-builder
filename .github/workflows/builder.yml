name: Automated Image Builds
on:
  push:
    paths-ignore:
    # Changes to these artifacts are autogenerated by this workflow
    # ignore them to prevent an infinite CI loop
    - '*.md'
jobs:
  build:
    runs-on: ubuntu-18.04
    env:
      VAR: ":0"
    continue-on-error: true
    steps:
      - name: Checkout source
        uses: actions/checkout@v2

      - name: Execute build
        run: |
          cd image-builder
          ./RootStock-NG.sh -c machinekit-debian-stretch
          IMG_DIR=`ls -d deploy/debian*`
          cd ${IMG_DIR}
          sudo ./setup_sdcard.sh --img-4gb bone-example --dtb beaglebone --distro-bootloader --enable-cape-universal --enable-uboot
